<!DOCTYPE html><html lang="fr"><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><title>Installer Arch Linux - WikiDoc</title><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/dracula.min.css"/><link rel="stylesheet" href="https://boxydev.github.io/WikiDoc/css/main.css"/></head><body><nav><div class="wrap"><a class="nav-home" href="https://boxydev.github.io/WikiDoc/index.html"><img class="nav-logo" src="https://www.boxydev.com/img/logo.png" alt="WikiDoc"/>  WikiDoc</a><div class="nav-list"><ul class="nav-left"><li><a class="" href="https://boxydev.github.io/WikiDoc/index.html">Accueil</a></li><li><a class="" href="https://boxydev.github.io/WikiDoc/about.html">A propos</a></li></ul><ul class="nav-right"><li><a target="_blank" href="https://github.com/Boxydev/WikiDoc">GitHub</a></li></ul></div></div></nav><section class="wrap page-content"><a class="edit-page-link" href="https://github.com/boxydev/WikiDoc/tree/master/src/data/pages/linux/installer-arch-linux.md" target="_blank">Modifier sur GitHub</a><div><h1 id="installer-arch-linux">Installer Arch Linux</h1>
<p>Nous nous sommes inspirés du <a href="https://wiki.archlinux.org/index.php/Installation_guide" target="_blank">Wiki original d&#39;Arch Linux</a> tout en gardant les étapes les plus importantes. N&#39;hésitez pas à apporter vos modifications sur le Github si besoin.</p>
<h2 id="pr-installation">Pré-installation</h2>
<p>On commence par aller chercher <a href="http://mir.archlinux.fr/iso/latest/" target="_blank">la dernière ISO</a>. On boot sur le live CD. Chez Boxydev, toutes les cartes mères ont un système UEFI mais on peut vérifier que l&#39;on est bien sur ce mode.</p>
<pre><code class="lang-bash">$ ls /sys/firmware/efi/efivars
</code></pre>
<p>On vérifie que l&#39;on est bien connecté à Internet.</p>
<pre><code class="lang-bash">$ ping boxydev.com
</code></pre>
<h3 id="partition-des-disques">Partition des disques</h3>
<p>On vérifie les disques et on choisit celui sur lequel on veut installer notre Arch.</p>
<pre><code class="lang-bash">$ fdisk -l
</code></pre>
<p>Une fois le disque /dev/sdX choisi, on peut utiliser cfdisk qui est plus facile, bien sûr le X est à remplacer par la lettre du disque dur concerné.</p>
<pre><code class="lang-bash">$ cfdisk /dev/sdX
</code></pre>
<p>Au plus simple, il y a 2 partitions à faire :</p>
<ul>
<li>La partition racine <code>/</code> (<code>/dev/sdX1</code> dans notre exemple).</li>
<li>La partition EFI ou ESP (<code>/dev/sdX2</code> dans notre exemple).</li>
</ul>
<p>Chez Boxydev, nous installons Windows sur nos machines (baaaaaaah) avant Linux car c&#39;est le seul moyen d&#39;avoir un dual boot correct (Windows n&#39;accepte qu&#39;un ESP vide sans Linux...). De ce fait, la partition EFI est forcément existante donc n&#39;a pas besoin d&#39;être créé mais juste monté.</p>
<h3 id="formater-monter-les-partitions">Formater / Monter les partitions</h3>
<p>On peut maintenant formatter et monter les partitions (Attention, on ne formatte pas la partition EFI).</p>
<pre><code class="lang-bash">mkfs.ext4 /dev/sdX1
mount /dev/sdX1 /mnt
mkdir -p /mnt/boot/efi
mount /dev/sdX2 /mnt/boot/efi
</code></pre>
<p>On utilisera <a href="https://git.archlinux.org/arch-install-scripts.git/tree/genfstab.in" target="_blank">genfstab</a> plus tard pour générer le fichier <code>/etc/fstab</code> sans se prendre la tête.</p>
<h2 id="installation">Installation</h2>
<p>Passons maintenant à l&#39;installation de notre OS préféré. On va commencer par utiliser le script pacstrap afin de bootstrapper le système de base.</p>
<pre><code class="lang-bash">pacstrap /mnt base
</code></pre>
<p>Voilà, c&#39;est terminé, une installation Linux plus simple que celle de Windows.</p>
<h2 id="configuration-du-syst-me">Configuration du système</h2>
<h3 id="fstab">Fstab</h3>
<p>Il faut générer le fichier <code>/etc/fstab</code> afin que les partitions soient automatiquement montées au démarrage. Nous l&#39;avons déjà fait alors ne nous répétons pas.</p>
<pre><code class="lang-bash">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab
</code></pre>
<p>Un petit <code>cat /mnt/etc/fstab</code> nous permet de checker que tout s&#39;est bien passé.</p>
<h3 id="chroot">Chroot</h3>
<p>On peut maintenant se chrooter dans la matrice.</p>
<pre><code class="lang-bash">arch-chroot /mnt
</code></pre>
<h3 id="la-timezone">La timezone</h3>
<p>On se branche sur Paris.</p>
<pre><code class="lang-bash">ln -sf /usr/share/zoneinfo/Europe/Paris /etc/localtime
</code></pre>
<h3 id="les-locales">Les locales</h3>
<p>On décommente <code>en_US.UTF-8 UTF-8</code> et <code>fr_FR.UTF-8 UTF-8</code> dans le fichier <code>/etc/locale.gen</code> et on génére le fichier.</p>
<pre><code class="lang-bash">locale-gen
</code></pre>
<p>On set la variable d&#39;environnement.</p>
<pre><code class="lang-bash">nano /etc/locale.conf
LANG=fr_FR.UTF-8
</code></pre>
<p>On fait la même chose pour le clavier français.</p>
<pre><code class="lang-bash">nano /etc/vconsole.conf 
KEYMAP=fr
</code></pre>
<h3 id="hostname">Hostname</h3>
<p>On configure le hostname.</p>
<pre><code class="lang-bash">nano /etc/hostname
myhostname
</code></pre>
<p>Et on fait aussi le fichier hosts.</p>
<pre><code class="lang-bash">nano /etc/hosts
127.0.0.1   localhost.localdomain    localhost
::1         localhost.localdomain    localhost
127.0.1.1   myhostname.localdomain   myhostname
</code></pre>
<h3 id="mot-de-passe-root">Mot de passe root</h3>
<p>On configure le mot de passe root.</p>
<pre><code class="lang-bash">passwd
</code></pre>
<h3 id="chargeur-de-d-marrage">Chargeur de démarrage</h3>
<p>Chez Boxydev, on choisit Grub 2. On va donc l&#39;installer avec efibootmgr et os-prober.</p>
<pre><code class="lang-bash">pacman -S grub efibootmgr os-prober
</code></pre>
<p>Efibootmgr peut servir à clean certaines entrées qui ne sont plus utilisées dans le menu UEFI.</p>
<p>On pose Grub dans le repertoire boot, on génére le fichier de configuration et c&#39;est terminé pour Grub.</p>
<pre><code class="lang-bash">mkdir -p /boot/efi/EFI/arch
grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=arch --recheck
grub-mkconfig -o /boot/grub/grub.cfg
</code></pre>
<h3 id="reboot">Reboot</h3>
<p>On peut maintenant redémarrer le système après avoir démonter les partitions <code>umount -R /mnt</code></p>
</div></section><footer><div class="wrap">Copyright © 2018 Boxydev Inc.</div></footer><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://boxydev.github.io/WikiDoc/js/app.js"></script></body></html>